/*!
 * JSMovieclip V1.0
 * https://github.com/jeremypetrequin/jsMovieclip
 * Copyright 2013 Jeremy Petrequin
 * Released under the MIT license
 * https://github.com/jeremypetrequin/jsMovieclip/blob/master/MIT-license.txt
 */
(function(){function a(c,e){if(!c){return this}var b=this,d=c.toString();b.elmts=d==="[object Array]"||d==="[object NodeList]"||d==="[object HTMLCollection]"||d==="[object Object]"?c:[c];d=null;b.playing=false;b.framerate=e.framerate||25;b.frames=[];b.loop=false;b.elmtsLength=b.elmts.length;b.stopCallback=e.stopCallback||null;b.firstFrame=1;b.lastFrame=1;b._label="";b._idx=0;b._timer=null;b._tmpFrames=[];b._way=1;b._framesNumber=e.frames_number||0;b.updateFrames(e.frames,e.direction,e.width,e.height,e.frames_number)}a.prototype={_render:function(){var c=this.elmtsLength,b=this;while(c--){this.elmts[c].style.backgroundPosition=this._tmpFrames[this._idx]}if(b.playing){if(b._idx>=b.lastFrame-1){if(!b.loop){b.stop();return}b._idx=b.firstFrame-1}else{b._idx++}}},_enterFrame:function(){var b=this;b._render.call(b);if(b.playing){b._timer=setTimeout(function(){b._enterFrame.call(b)},1000/b.framerate)}},_calculateFrames:function(){this._tmpFrames=[];if(this._way===1){this._tmpFrames=this.frames}else{var b=this.frames.length;while(b--){this._tmpFrames.push(this.frames[b])}}this._framesNumber=this.frames.length;return this.clearLoopBetween()},_cacheFrames:function(){var c=this.frames,b=c.length;this.frames=[];while(b--){this.frames[b]="-"+c[b].x+"px -"+c[b].y+"px"}return this},updateFrames:function(g,f,e,b,c){if(g){this.frames=g;return this._cacheFrames()._calculateFrames()}if(!g&&!f){throw"JSMovieclip need at least frames array or a direction "}if(f==="v"&&!b){throw"If you want to use a vertical sprite, JSMoviclip need a height"}if(f==="h"&&!e){throw"If you want to use a horizontal sprite, JSMoviclip need a width"}if(!c){throw"If you want to use a horizontal of vertical sprite, JSMoviclip need a number of frame"}var d=0;for(;d<c;d++){this.frames.push({x:(f==="h"?d*e:0),y:(f==="v"?d*b:0)})}d=null;return this._cacheFrames()._calculateFrames()},getWay:function(){return this._way},changeWay:function(c,b){if(c===this._way){return this}b=!!b;if(b===true){this._idx=this._framesNumber-this._idx}this._way=c;return this._calculateFrames()},clearLoopBetween:function(){this.firstFrame=1;this.lastFrame=this._framesNumber;return this},loopBetween:function(c,b){if(c>=b){c=b;throw"Firstframe and lastframe are equals or inverted"}this.firstFrame=Math.max(c,1);this.lastFrame=Math.min(b,this._framesNumber);if(this._idx<this.firstFrame-1||this._idx>this.lastFrame-1){this._idx=this.firstFrame-1}return this},currentFrame:function(){return this._idx+1},prevFrame:function(){var b=this.currentFrame();return this.gotoAndStop(b<=this.firstFrame?this.lastFrame:b-1)},nextFrame:function(){var b=this.currentFrame();return this.gotoAndStop(b>=this.lastFrame?1:b+1)},toggle:function(b){return !this.playing?this.play(b):this.stop()},play:function(b){if(this.playing){return this}if(this._idx===this.lastFrame-1){this._idx=this.firstFrame-1}this.playing=true;this.loop=!!b;this._enterFrame();return this},stop:function(){this.playing=false;if(this._timer){clearTimeout(this._timer);this._timer=null}if(this.stopCallback){this.stopCallback()}return this},gotoAndPlay:function(c,b){this._idx=Math.min(Math.max(c,this.firstFrame),this.lastFrame)-1;return this.play(b)},gotoAndStop:function(b){this._idx=Math.min(Math.max(b,this.firstFrame),this.lastFrame)-1;this.loop=false;this.playing=false;this._enterFrame();return this}};window.JSMovieclip=a})();